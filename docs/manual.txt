【東京支店】①案件取込用レポート20250722.csvという「アークの元データ」を受け取る(20250722の部分はYYYYMMDDなので変動します。)
ContractList＊.csv

この2つのcsvを加工し、111列のCSVファイルに最終的にアウトプットする。最終的なアウトプットのファイル名は「MMDDアーク新規登録.csv」となる。MMDDには当日の日付が動的に入る。
ContractListのB列「引継番号」と「東京支店①案件取込用レポート」のA列「契約番号」と照合する。ContractListに記載されていれば登録が不要なので、除外する。
【東京支店】①をいったん別Sheet（Sheet1）に内容をコピペする。「新規案件情報CSV」に登録します
【東京支店】A列「契約番号」をテンプレートの「引継番号」A列へコピペする「引継番号」の先頭に0をつける。でないと登録できないから
【東京支店】B列「契約元帳:主契約者」をテンプレートのB列「契約者氏名」にコピペする。名字と名前の間の全角スペースを取り除く。【東京支店】C列「主契約者（カナ）」をテンプレートのC列「契約者カナ」にコピペする  名字と名前の間の半角スペースを取り除く。
【東京支店】D列「生年月日1 」をテンプレートのD列「契約者生年月日」にコピペする。生年月日で明らかな入力エラー、外れ値があったら、その場合はデータごと除外する。例えば、1900年以前の生年月日など。
【東京支店】E列「自宅TEL1」をテンプレートのE列「契約者TEL自宅」にコピペする【東京支店】F列「携帯TEL1」をテンプレートのF列「契約者TEL携帯」にコピペする【東京支店】もし「自宅TEL1」に番号が格納されていて、かつ「携帯TEL1」に番号がない場合、「自宅TEL1」の番号を「携帯TEL1」に移動させる
【東京支店】K列「物件住所」を加工してテンプレG、H、I、J列に入力するテンプレートのG列「契約者現住所郵便番号」に郵便番号をコピペ。例：260-0811テンプレートのH列「契約者現住所1」に都道府県をコピペ。例：千葉県テンプレートのI列「契約者現住所2」に「市区町村」をコピペ。例：千葉市中央区テンプレートのJ列「契約者現住所3」に「市区町村以降の住所すべて、全角スペース、物件名、全角スペース、部屋番号」をコピペ。例：大森町341-2　レオパレス　202
テンプレートのL列「物件名」に【東京支店】I列「物件名」をコピペするテンプレートのM列「部屋番号」に【東京支店】J列「部屋番号」をコピペするテンプレートのN列「物件住所郵便番号」に【東京支店】K列「物件住所」の中の郵便番号をコピペするテンプレートのO列「物件住所1」に【東京支店】「物件住所」の中の都道府県コピペするテンプレートのP列「物件住所2」に【東京支店】「物件住所」の中の市区町村をコピペする。テンプレートのQ列「物件住所3」に【東京支店】「物件住所」の中の市区町村以降をすべてコピペする。テンプレートのR列「入居ステータス」に「入居中」と入れるテンプレートのS列「滞納ステータス」に「未精算」と入れるテンプレートのT列「受託状況」に「契約中」と入れるテンプレートのU列「月額賃料」に【東京支店】M列「賃料」をコピペするテンプレートのV列「管理費」に【東京支店】のN列「管理共益費」をコピペする。テンプレートのW列「共益費」とX列「水道代」に数値０を入れるテンプレートのY列 「駐車場代」に【東京支店】のO列「駐車場料金」をコピペするテンプレートのZ列「その他費用1」に【東京支店】P列「その他料金」をコピペする。
テンプレートのAA列 「その他費用2」に【東京支店】Q列「決済サービス料」をコピペする。テンプレートのAB列「敷金」は空白にする。テンプレートのAC列「礼金」は空白にする。テンプレートのAD列「回収口座金融機関CD」に「310」と入れるテンプレートのAE列「回収口座金融機関名」に「GMOあおぞらネット銀行」と入れるテンプレートのAF列は空白にする。テンプレートのAG列「回収口座支店名」に【東京支店】S列「バーチャル口座（支店）」をコピペするテンプレートのAH列「回収口座種類」に「普通」と入れるテンプレートのAI列「回収口座番号」に【東京支店】の「バーチャル口座（口座番号）」をコピペするテンプレートのAJ列「回収口座名義」に「アーク株式会社」と入れるテンプレートのAK列「契約種類」に「バックレント」と入れるテンプレートのAL列「管理受託日」に本日の日付をYYYY/MM/DDの形式で入れるテンプレートのAN列、AO列、AP列には０を入れるテンプレートのAQ列「管理前滞納額」には【東京支店】U列「未収金額合計」をコピペする。テンプレートのAR列「更新契約手数料」には1と入れるテンプレートのAS列「退去手続き（実費）」には【東京支店】の「月額賃料」と「管理費」と「駐車場代」と「その他費用1」を足し合わせた合計をコピペしていく。ただし合計が70000を下回った場合は70000と入れていく。
テンプレートのAV列「クライアントCD」には10を入れるテンプレートのAX列「契約者勤務先名」に【東京支店】V列「勤務先1」をコピペする。テンプレートのAZ列「契約書勤務先TEL」に【東京支店】W列「勤務先TEL1」をコピペするテンプレートのBA列「勤務先業種」は空白にするテンプレートのBB列「契約書勤務先郵便番号」を入れるテンプレートのBC列「契約者勤務先住所1」に【東京支店】Y列「勤務先住所1」の都道府県を入れるテンプレートのBD列「契約者勤務先住所2」に【東京支店】Y列「勤務先住所1」の市区町村を入れるテンプレートのBE列「契約者勤務先住所3」に【東京支店】Y列「勤務先住所1」の市区町村以降すべてを入れる
【東京支店】の保証人・緊急連絡人情報について：
・Z列「名前2」：保証人または緊急連絡人の氏名
・AA列「カナ2」：保証人または緊急連絡人のカナ
・AB列「種別／続柄２」：「保証人」または「緊急連絡」が含まれているかで判定（部分一致）
・AC列「生年月日2」：保証人または緊急連絡人の生年月日
・AD列「自宅TEL2」：保証人または緊急連絡人の自宅電話
・AE列「携帯TEL2」：保証人または緊急連絡人の携帯電話
・AF列「自宅住所2」：保証人または緊急連絡人の住所

【東京支店】AB列「種別／続柄２」列を元に「保証人」と「緊急連絡人」を判定して、分ける。
もし「保証人」が含まれていればBF列~BO列に情報を格納する。もし「緊急連絡」が含まれていればBZ~CH列に情報を格納する。

テンプレートの BF列「保証人１氏名」に【東京支店】Z列「名前2」をコピペ（「保証人」の場合のみ）
テンプレートの BG列「保証人１カナ」に【東京支店】AA列「カナ2」をコピペ（「保証人」の場合のみ）
テンプレートの BH列「保証人１契約者との関係」に「他」と入れる（保証人データがある場合のみ）
テンプレートの BI列「保証人１生年月日」に【東京支店】AC列「生年月日2」をコピペ（「保証人」の場合のみ）
テンプレートの BJ列「保証人１郵便番号」に【東京支店】AF列「自宅住所2」から郵便番号を抽出（「保証人」の場合のみ）
テンプレートの BK列「保証人１住所1」に【東京支店】AF列「自宅住所2」から都道府県を抽出（「保証人」の場合のみ）
テンプレートの BL列「保証人１住所2」に【東京支店】AF列「自宅住所2」から市区町村を抽出（「保証人」の場合のみ）
テンプレートの BM列「保証人１住所3」に【東京支店】AF列「自宅住所2」から市区町村以降すべてを抽出（「保証人」の場合のみ）
テンプレートの BN列「保証人１TEL自宅」に【東京支店】AD列「自宅TEL2」をコピペ（「保証人」の場合のみ）
テンプレートの BO列「保証人１TEL携帯」に【東京支店】AE列「携帯TEL2」をコピペ（「保証人」の場合のみ）

テンプレートのBZ列「緊急連絡人１氏名」に【東京支店】Z列「名前2」をコピペ（「緊急連絡」の場合のみ）
テンプレートのCA列「緊急連絡人１カナ」に【東京支店】AA列「カナ2」をコピペ（「緊急連絡」の場合のみ）
テンプレートのCB列「緊急連絡人１契約者との関係」に「他」と入れる（緊急連絡人データがある場合のみ）
テンプレートのCC列「緊急連絡人１郵便番号」に【東京支店】AF列「自宅住所2」から郵便番号を抽出（「緊急連絡」の場合のみ）
テンプレートのCD列「緊急連絡人１住所1」に【東京支店】AF列「自宅住所2」から都道府県を抽出（「緊急連絡」の場合のみ）
テンプレートのCE列「緊急連絡人１住所2」に【東京支店】AF列「自宅住所2」から市区町村を抽出（「緊急連絡」の場合のみ）
テンプレートのCF列「緊急連絡人１住所3」に【東京支店】AF列「自宅住所2」から市区町村以降すべてを抽出（「緊急連絡」の場合のみ）
テンプレートのCG列「緊急連絡人１TEL自宅」に【東京支店】AD列「自宅TEL2」をコピペ（「緊急連絡」の場合のみ）
テンプレートのCH列「緊急連絡人１TEL携帯」に【東京支店】AE列「携帯TEL2」をコピペ（「緊急連絡」の場合のみ）
テンプレートのDB列「管理会社」に【東京支店】H列「取引先」をコピペする。テンプレートのDC列「引継情報」に「●20日～25日頃に督促手数料2,750円or2,970円が加算されることあり。案内注意！！　●入居日：YYYY/MM/DD」と入れる。入居日は【東京支店】AN列「入居日」を参照する。




