# アーク新規登録データ変換ツール - 実装完了

## 実装したモジュール

### 1. **config.py**
- 出力カラム定義（99カラム）
- 固定値設定
- カラムマッピング定義
- 住所分割対象の設定
- 検証ルール

### 2. **utils.py**
- 文字列変換関数（全角/半角スペース除去、カナ変換）
- 電話番号正規化
- 日付フォーマット変換
- 金額計算（退去手続き費用）
- 引継情報生成

### 3. **address_splitter.py**
- 住所を郵便番号、都道府県、市区町村、それ以降に分割
- 東京23区の特別処理
- 建物名・部屋番号の結合機能

### 4. **data_loader.py**
- CSVファイルの読み込み（CP932対応）
- エンコーディング自動検出
- 最新ファイルの自動検索機能

### 5. **data_validator.py**
- 重複チェック（ContractListとの照合）
- 生年月日の妥当性検証（1900年以前を除外）
- 必須フィールドの検証

### 6. **data_transformer.py**
- データ変換のメイン処理
- 電話番号の条件付き振り分け
- 保証人/緊急連絡人の自動判定
- 住所分割処理
- 各種計算フィールドの生成

### 7. **data_exporter.py**
- CSV出力（CP932エンコーディング）
- エラーログ出力
- 処理レポート生成

### 8. **main.py**
- メイン実行ファイル
- コマンドライン引数対応
- 処理フローの制御

## 使用方法

### 基本的な使い方
```bash
# 依存パッケージのインストール
pip install -r requirements.txt

# 実行（ファイルは自動検索）
python main.py

# ファイルを指定して実行
python main.py --report "【東京支店】①案件取込用レポート20250722.csv" --contract-list "ContractList_20250723150613.csv"
```

### コマンドラインオプション
- `--report`: 案件取込用レポートのパス
- `--contract-list`: ContractListのパス
- `--output`: 出力ファイルのパス
- `--downloads-dir`: ダウンロードディレクトリ（デフォルト: C:\Users\user04\Downloads）
- `--output-dir`: 出力ディレクトリ（デフォルト: カレントディレクトリ）
- `--skip-report`: 処理レポートの生成をスキップ

## 出力ファイル
1. **メイン出力**: `MMDDアーク新規登録.csv`（当日の日付）
2. **エラーログ**: `error_log_YYYYMMDD_HHMMSS.txt`（エラーがある場合）
3. **処理レポート**: `processing_report_YYYYMMDD_HHMMSS.txt`

## 主な機能
- 重複データの自動除外
- 異常な生年月日（1900年以前）の除外
- 氏名・カナの空白除去
- 住所の自動分割
- 電話番号の条件付き振り分け
- 保証人/緊急連絡人の自動判定
- 退去手続き費用の計算（最低7万円）
- 引継情報の動的生成